I'm pretty sure that this million line thing can be done mathematically, and not using programmatical brute forcing. 
This is a biased answer but this was probably true from the first place.

...#......
.......#..
#.........
..........
......#...
.#........
.........#
..........
.......#..
#...#.....

We can simply overhaul the part where we add more lines into simply modifying i or j values.

For each empty row, i or j values would have shifted by 1. 
Just replace this shift with 999999. 

